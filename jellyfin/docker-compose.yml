version: "3.8"

services:
  jellyfin:
    image: linuxserver/jellyfin:latest
    container_name: jellyfin
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/jellyfin:/config
      - ${MEDIA_LOCATION:-/home/dagmarb/jellyfin/media}:/media
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "8096:8096"
      - "8920:8920"
    restart: unless-stopped
    devices:
      - /dev/dri:/dev/dri # optional: Intel VA-API
    networks:
      - shared

  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
      - WEBUI_PORT=8080
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/qbittorrent:/config
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "${QBIT_WEBUI_PORT:-8081}:8080"
      - "6881:6881"
      - "6881:6881/udp"
    restart: unless-stopped
    networks:
      - shared

  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/radarr:/config
      - ${MEDIA_LOCATION:-/home/dagmarb/jellyfin/media}/movies:/movies
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "7878:7878"
    restart: unless-stopped
    networks:
      - shared

  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/sonarr:/config
      - ${MEDIA_LOCATION:-/home/dagmarb/jellyfin/media}/tv:/tv
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "8989:8989"
    restart: unless-stopped
    networks:
      - shared

  lidarr:
    image: lscr.io/linuxserver/lidarr:latest
    container_name: lidarr
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/lidarr:/config
      - ${MEDIA_LOCATION:-/home/dagmarb/jellyfin/media}/music:/music
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "8686:8686"
    restart: unless-stopped
    networks:
      - shared

  readarr:
    image: ghcr.io/pennydreadful/bookshelf:softcover
    container_name: readarr
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/readarr:/config
      - ${MEDIA_LOCATION:-/home/dagmarb/jellyfin/media}/audiobooks:/audiobooks
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "8787:8787"
    restart: unless-stopped
    networks:
      - shared

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/prowlarr:/config
    ports:
      - "9696:9696"
    restart: unless-stopped
    networks:
      - shared

  seerr-init:
    image: alpine:latest
    container_name: seerr-init
    command: sh -c "mkdir -p /app/config/logs && chown -R 1000:1000 /app/config && chmod -R 755 /app/config"
    volumes:
      - seerr_config:/app/config
    restart: "no"

  seerr:
    image: ghcr.io/seerr-team/seerr:latest
    container_name: seerr
    init: true
    depends_on:
      - seerr-init
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - seerr_config:/app/config
    ports:
      - "5055:5055"
    restart: unless-stopped
    networks:
      - shared

  bazarr:
    image: lscr.io/linuxserver/bazarr:latest
    container_name: bazarr
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/bazarr:/config
      - ${MEDIA_LOCATION:-/home/dagmarb/jellyfin/media}:/media
      - ${DOWNLOADS_LOCATION:-/home/dagmarb/jellyfin/downloads}:/downloads
    ports:
      - "6767:6767"
    restart: unless-stopped
    networks:
      - shared

  tvheadend:
    image: linuxserver/tvheadend:latest
    container_name: tvheadend
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-Etc/UTC}
    volumes:
      - ${CONFIG_LOCATION:-/home/dagmarb/jellyfin/config}/tvheadend:/config
    ports:
      - "9981:9981"
      - "9982:9982"
    restart: unless-stopped
    networks:
      - shared

networks:
  shared:
    external: true

volumes:
  seerr_config:
